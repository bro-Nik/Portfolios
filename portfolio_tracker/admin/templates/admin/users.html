{% extends "base.html" %}
{% block title %} Users / Admin {% endblock %}
{% block content %}

{% include 'admin/menu.html' %}

<div class="big-table pt-3 pb-3">
  <table class="table table-sm align-middle table-hover" id="Table" data-toggle="table" data-search="true">
    <thead>
      <tr>
        <th data-sortable="true">ID</th>
        <th data-sortable="true">Email</th>
        <th data-sortable="true" title="Администратор">A</th>
        <th data-sortable="true">П</th>
        <th data-sortable="true">A</th>
        <th data-sortable="true">Total</th>
        <th data-sortable="true">First visit</th>
        <th data-sortable="true">Last visit</th>
        <th data-sortable="true">Country</th>
        <th data-sortable="true">City</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
        <tr>
          <td>{{ user.id }}</td>
          <td>{{ user.email }}</td>
          <td>{% if user.type == 'admin' %}<b title="Администратор">A</b>{% endif %}</td>
          <td>{{ user.portfolios|length }}</td>
          <td>{{ user.assets|length }}</td>

          <td>{{ user.info.first_visit }}</td>
          <td>{{ user.info.last_visit }}</td>
          <td>{{ user.info.country }}</td>
          <td>{{ user.info.city }}</td>

          <td class="align-middle text-end">
	          <div class="dropdown dropstart">
	            <a href="#" class="link-secondary" role="button" id="dropdownAction" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ms-2" viewBox="0 0 16 16"><path d="M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"/></svg>
              </a>
              <div class="dropdown-menu" aria-labelledby="dropdownAction">
                {% if user.type != 'admin' %}
                    <a class="dropdown-item open-modal" href="{{url_for('.user_to_admin', user_id=user.id)}}"  data-url="">
                      Сделать администратором
                    </a>
                {% endif %}
                <a class="dropdown-item link-danger {{ 'open-modal-confirmation' if False else 'opacity-25 disabled' }}" data-action="delete" data-title="Удалить пользователя?" data-id="">
                  Удалить
                </a>
              </div>
            </div>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
